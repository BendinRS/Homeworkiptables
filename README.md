# Домашняя работа "Сценарии iptables" 


 [test.sh](test.sh) **выполняет** **задание** **с** **iptables**


+ добавить inetRouter2, который виден(маршрутизируется (host-only тип сети для виртуалки)) с хоста или форвардится порт через локалхост

+ Запустить nginx на centralServer

+ Пробросить 80й порт на inetRouter2 8080

+ Дефолт в инет оставить через inetRouter

Вышеперечисленные задачи выполняет роль [iptables_lite](./roles/iptables_lite/)

Задание выполняется прямым запихиванием правил в таблицы и цепочки iptables

Так же сконфигурирована роль [iptables](./roles/iptables), в которой развернуты пакеты iptables и iptables-services
Проблема заключается в том, что ансибл не может корректно перезагрузить сервис iptables после того, как был подсунут новый конфиг. 
Решается путем ручного входа на хост inetRouter2 --> Внесением любого символа за комментирование в конфиг ---> restart
В интернетах не смог найти обьяснение. Логи ругаются на синтаксис, ноо см. решение выше и взорви себе мозК :)

реализовать knocking port

[Помощь](https://otus.ru/nest/post/267/) в настройке 

Реализация в [скрине](https://i.ibb.co/VqNP9Xz/1.png)

   ![Альтернативный текст](https://i.ibb.co/VqNP9Xz/1.png)


